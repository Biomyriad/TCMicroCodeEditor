<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>MicroCode Editor</title>
  <link rel="stylesheet" href="styles.css">
  <script src="main.js"></script>

  <style>
    #content {
      display: flex;
      justify-content: left;
      gap: 10px;
    }
  
    .scroll-box {
      background: grey;
      margin-bottom: 5px;
      padding: 2px;
      border: 3px solid #b7b7b7;
      overflow: hidden;
      overflow-y: auto;
    }
    
    #opcode-listbox {
      height: 400px;
      width: 240px;
    }
    
    #opcode-ctrllist {
      height: 400px;
      min-width: 600px;
    }
    
  </style>

</head>
<body onload="initApp()">
  <div id="content">
    <div id="opcodelistbox">   <!-- OP Code List -->
      <div class="scroll-box" id="opcode-listbox"></div>
      <div style="margin-bottom: 5px;">
        <input type="text" id="new-op-code" style="width: 47px;" autocomplete="off">
        <input type="text" id="new-op-mnem" style="width: 125PX;" autocomplete="off">
        <input type="text" id="update-op-code" style="width: 47px;" autocomplete="off">
      </div>
      <div style="display: flex; justify-content: center; gap: 5px">
        <button onclick="saveOpCode()" style="width: 57px;">Save</button>
        <button onclick="deleteOpCode()" style="width: 57px;">Delete</button>
      </div>    
    </div>
    
    <div id="opcodectrllinedisplay">
      <div class="scroll-box" id="opcode-ctrllist"></div>
    </div>
  </div>

  <div style="margin-top: 10px;">
    <button onclick="TEST()" style="width: 57px;">TEST</button>
    <button onclick="TEST2()" style="width: 57px;">TEST2</button>
  </div>

  <script>
    //OpCode List
    var opCodeListBox = document.getElementById('opcode-listbox')
    var newOpCodeTbx = document.getElementById('new-op-code')
    var newOpMnemTbx = document.getElementById('new-op-mnem')
    var updateOpCodeTbx = document.getElementById('update-op-code')
  
    function deleteOpCode() {
      if(newOpCodeTbx.value == "") return
      removeOpCode(newOpCodeTbx.value)
      opCodeListBoxRefresh()
      newOpCodeTbx.value = ''
    }

    function saveOpCode() {
      if(newOpCodeTbx.value == "" || newOpMnemTbx.value == "") return
      addUpdateOpCode(
        newOpCodeTbx.value,
        newOpMnemTbx.value,
        updateOpCodeTbx.value == "" ? updateOpCodeTbx.value : false
      )
      opCodeListBoxRefresh()
      newOpCodeTbx.value = ''
      newOpMnemTbx.value = ''
      updateOpCodeTbx.value = ''
    }

    function createOpCodeListEle(opCode, opMnem) {
      let ele = document.createElement("div")
      let tx1 = document.createElement("span")
      let tx2 = document.createElement("span")
      let tx3 = document.createElement("span")

      ele.addEventListener("click", opCodeEleClickHandler);
      ele.id = "opcodeid-" + opCode
      tx1.innerText = opCode
      tx2.innerText = ' - '
      tx3.innerText = opMnem
      ele.appendChild(tx1)
      ele.appendChild(tx2)
      ele.appendChild(tx3)

      return ele
    }

    function opCodeEleClickHandler(event) {
      alert(this.id + " --- " + event.target);
    }

    function opCodeListBoxRefresh() {
      if(opCodeList != null){
        opCodeListBox.replaceChildren()
        opCodeList.forEach((item)=>{
          opCodeListBox.appendChild(
            createOpCodeListEle(item.code,item.mnemonic)
          )
        })        
      }
    }

    // --------- ONLOAD ------------
    function initApp() {
      loadState()
      opCodeListBoxRefresh()
    }
//-------------------
    function TEST() {

    }
    function TEST2() {

    }


  </script>

</body>
</html>